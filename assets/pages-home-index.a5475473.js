import{d as t,m as e,a as i,b as s,c as a,o as l,e as r,w as o,f as n,t as d,n as u,g as h,h as c,i as p,j as g,k as m,s as f,l as b,r as y,p as v,q as _,u as w,v as x,F as S,x as k,y as L,S as C,z as A,A as T,B as N,C as B,D,E as I,G as O,H as R,I as z,J as $,K as U,L as V}from"./index-ddf588be.js";import{_ as H}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as W,a as Y}from"./u-lazy-load.27866e97.js";import{l as F,e as Z}from"./errorImg.ac5c5434.js";const j=H({name:"u-badge",mixins:[e,{props:{isDot:{type:Boolean,default:()=>t.badge.isDot},value:{type:[Number,String],default:()=>t.badge.value},modelValue:{type:[Number,String],default:()=>t.badge.modelValue},show:{type:Boolean,default:()=>t.badge.show},max:{type:[Number,String],default:()=>t.badge.max},type:{type:String,default:()=>t.badge.type},showZero:{type:Boolean,default:()=>t.badge.showZero},bgColor:{type:[String,null],default:()=>t.badge.bgColor},color:{type:[String,null],default:()=>t.badge.color},shape:{type:String,default:()=>t.badge.shape},numberType:{type:String,default:()=>t.badge.numberType},offset:{type:Array,default:()=>t.badge.offset},inverted:{type:Boolean,default:()=>t.badge.inverted},absolute:{type:Boolean,default:()=>t.badge.absolute}}},i],computed:{boxStyle:()=>({}),badgeStyle(){const t={};if(this.color&&(t.color=this.color),this.bgColor&&!this.inverted&&(t.backgroundColor=this.bgColor),this.absolute&&(t.position="absolute",this.offset.length)){const e=this.offset[0],i=this.offset[1]||e;t.top=s(e),t.right=s(i)}return t},showValue(){switch(this.numberType){case"overflow":return Number(this.value)>Number(this.max)?this.max+"+":this.value;case"ellipsis":return Number(this.value)>Number(this.max)?"...":this.value;case"limit":return Number(this.value)>999?Number(this.value)>=9999?Math.floor(this.value/1e4*100)/100+"w":Math.floor(this.value/1e3*100)/100+"k":this.value;default:return Number(this.value)}}},methods:{addStyle:a}},[["render",function(t,e,i,s,a,g){const m=p;return t.show&&(0!==Number(t.value)||t.showZero||t.isDot)?(l(),r(m,{key:0,class:u([[t.isDot?"u-badge--dot":"u-badge--not-dot",t.inverted&&"u-badge--inverted","horn"===t.shape&&"u-badge--horn",`u-badge--${t.type}${t.inverted?"--inverted":""}`],"u-badge"]),style:h([g.addStyle(t.customStyle),g.badgeStyle])},{default:o((()=>[n(d(t.isDot?"":g.showValue),1)])),_:1},8,["class","style"])):c("",!0)}],["__scopeId","data-v-0e56696e"]]);const G=H({name:"u-tabs",mixins:[e,i,{props:{duration:{type:Number,default:()=>t.tabs.duration},list:{type:Array,default:()=>t.tabs.list},lineColor:{type:String,default:()=>t.tabs.lineColor},activeStyle:{type:[String,Object],default:()=>t.tabs.activeStyle},inactiveStyle:{type:[String,Object],default:()=>t.tabs.inactiveStyle},lineWidth:{type:[String,Number],default:()=>t.tabs.lineWidth},lineHeight:{type:[String,Number],default:()=>t.tabs.lineHeight},lineBgSize:{type:String,default:()=>t.tabs.lineBgSize},itemStyle:{type:[String,Object],default:()=>t.tabs.itemStyle},scrollable:{type:Boolean,default:()=>t.tabs.scrollable},current:{type:[Number,String],default:()=>t.tabs.current},keyName:{type:String,default:()=>t.tabs.keyName}}}],data:()=>({firstTime:!0,scrollLeft:0,scrollViewWidth:0,lineOffsetLeft:0,tabsRect:{left:0},innerCurrent:0,moving:!1}),watch:{current:{immediate:!0,handler(t,e){t!==this.innerCurrent&&(this.innerCurrent=t,this.$nextTick((()=>{this.resize()})))}},list(){this.$nextTick((()=>{this.resize()}))}},computed:{textStyle(){return t=>{const e={},i=t===this.innerCurrent?a(this.activeStyle):uni.$u.addStyle(this.inactiveStyle);return this.list[t].disabled&&(e.color="#c8c9cc"),g(i,e)}},propsBadge:()=>t.badge},async mounted(){this.init()},emits:["click","change"],methods:{addStyle:a,addUnit:s,setLineLeft(){const t=this.list[this.innerCurrent];if(!t)return;let e=this.list.slice(0,this.innerCurrent).reduce(((t,e)=>t+e.rect.width),0);const i=m(this.lineWidth);this.lineOffsetLeft=e+(t.rect.width-i)/2,this.firstTime&&setTimeout((()=>{this.firstTime=!1}),10)},animation(t,e=0){},clickHandler(t,e){this.$emit("click",{...t,index:e}),t.disabled||(this.innerCurrent=e,this.resize(),this.$emit("change",{...t,index:e}))},init(){f().then((()=>{this.resize()}))},setScrollLeft(){const t=this.list[this.innerCurrent],e=this.list.slice(0,this.innerCurrent).reduce(((t,e)=>t+e.rect.width),0),i=b().windowWidth;let s=e-(this.tabsRect.width-t.rect.width)/2-(i-this.tabsRect.right)/2+this.tabsRect.left/2;s=Math.min(s,this.scrollViewWidth-this.tabsRect.width),this.scrollLeft=Math.max(0,s)},resize(){0!==this.list.length&&Promise.all([this.getTabsRect(),this.getAllItemRect()]).then((([t,e=[]])=>{this.tabsRect=t,this.scrollViewWidth=0,e.map(((t,e)=>{this.scrollViewWidth+=t.width,this.list[e].rect=t})),this.setLineLeft(),this.setScrollLeft()}))},getTabsRect(){return new Promise((t=>{this.queryRect("u-tabs__wrapper__scroll-view").then((e=>t(e)))}))},getAllItemRect(){return new Promise((t=>{const e=this.list.map(((t,e)=>this.queryRect(`u-tabs__wrapper__nav__item-${e}`,!0)));Promise.all(e).then((e=>t(e)))}))},queryRect(t,e){return new Promise((e=>{this.$uGetRect(`.${t}`).then((t=>{e(t)}))}))}}},[["render",function(t,e,i,s,a,c){const g=p,m=y(v("u-badge"),j),f=L,b=C;return l(),r(f,{class:"u-tabs"},{default:o((()=>[_(f,{class:"u-tabs__wrapper"},{default:o((()=>[w(t.$slots,"left",{},void 0,!0),_(f,{class:"u-tabs__wrapper__scroll-view-wrapper"},{default:o((()=>[_(b,{"scroll-x":t.scrollable,"scroll-left":a.scrollLeft,"scroll-with-animation":"",class:"u-tabs__wrapper__scroll-view","show-scrollbar":!1,ref:"u-tabs__wrapper__scroll-view"},{default:o((()=>[_(f,{class:"u-tabs__wrapper__nav",ref:"u-tabs__wrapper__nav"},{default:o((()=>[(l(!0),x(S,null,k(t.list,((e,i)=>(l(),r(f,{class:u(["u-tabs__wrapper__nav__item",[`u-tabs__wrapper__nav__item-${i}`,e.disabled&&"u-tabs__wrapper__nav__item--disabled"]]),key:i,onClick:t=>c.clickHandler(e,i),ref_for:!0,ref:`u-tabs__wrapper__nav__item-${i}`,style:h([c.addStyle(t.itemStyle),{flex:t.scrollable?"":1}])},{default:o((()=>[_(g,{class:u([[e.disabled&&"u-tabs__wrapper__nav__item__text--disabled"],"u-tabs__wrapper__nav__item__text"]),style:h([c.textStyle(i)])},{default:o((()=>[n(d(e[t.keyName]),1)])),_:2},1032,["class","style"]),_(m,{show:!(!e.badge||!(e.badge.show||e.badge.isDot||e.badge.value)),isDot:e.badge&&e.badge.isDot||c.propsBadge.isDot,value:e.badge&&e.badge.value||c.propsBadge.value,max:e.badge&&e.badge.max||c.propsBadge.max,type:e.badge&&e.badge.type||c.propsBadge.type,showZero:e.badge&&e.badge.showZero||c.propsBadge.showZero,bgColor:e.badge&&e.badge.bgColor||c.propsBadge.bgColor,color:e.badge&&e.badge.color||c.propsBadge.color,shape:e.badge&&e.badge.shape||c.propsBadge.shape,numberType:e.badge&&e.badge.numberType||c.propsBadge.numberType,inverted:e.badge&&e.badge.inverted||c.propsBadge.inverted,customStyle:"margin-left: 4px;"},null,8,["show","isDot","value","max","type","showZero","bgColor","color","shape","numberType","inverted"])])),_:2},1032,["onClick","style","class"])))),128)),_(f,{class:"u-tabs__wrapper__nav__line",ref:"u-tabs__wrapper__nav__line",style:h([{width:c.addUnit(t.lineWidth),transform:`translate(${a.lineOffsetLeft}px)`,transitionDuration:`${a.firstTime?0:t.duration}ms`,height:c.addUnit(t.lineHeight),background:t.lineColor,backgroundSize:t.lineBgSize}])},null,8,["style"])])),_:1},512)])),_:1},8,["scroll-x","scroll-left"])])),_:1}),w(t.$slots,"right",{},void 0,!0)])),_:3})])),_:3})}],["__scopeId","data-v-9aa5a8f9"]]);const K=H({name:"u-sticky",mixins:[e,i,{props:{offsetTop:{type:[String,Number],default:()=>t.sticky.offsetTop},customNavHeight:{type:[String,Number],default:44},disabled:{type:Boolean,default:()=>t.sticky.disabled},bgColor:{type:String,default:()=>t.sticky.bgColor},zIndex:{type:[String,Number],default:()=>t.sticky.zIndex},index:{type:[String,Number],default:()=>t.sticky.index}}}],data:()=>({cssSticky:!1,stickyTop:0,elId:A(),left:0,width:"auto",height:"auto",fixed:!1}),computed:{style(){const t={};return this.disabled?t.position="static":this.cssSticky?(t.position="sticky",t.zIndex=this.uZindex,t.top=s(this.stickyTop)):t.height=this.fixed?this.height+"px":"auto",t.backgroundColor=this.bgColor,g(a(this.customStyle),t)},stickyContent(){const t={};return this.cssSticky||(t.position=this.fixed?"fixed":"static",t.top=this.stickyTop+"px",t.left=this.left+"px",t.width="auto"==this.width?"auto":this.width+"px",t.zIndex=this.uZindex),t},uZindex(){return this.zIndex?this.zIndex:T.sticky}},mounted(){this.init()},methods:{init(){this.getStickyTop(),this.checkSupportCssSticky(),this.cssSticky||!this.disabled&&this.initObserveContent()},initObserveContent(){this.$uGetRect("#"+this.elId).then((t=>{this.height=t.height,this.left=t.left,this.width=t.width,this.$nextTick((()=>{this.observeContent()}))}))},observeContent(){this.disconnectObserver("contentObserver");const t=N({thresholds:[.95,.98,1]});t.relativeToViewport({top:-this.stickyTop}),t.observe(`#${this.elId}`,(t=>{this.setFixed(t.boundingClientRect.top)})),this.contentObserver=t},setFixed(t){const e=t<=this.stickyTop;this.fixed=e},disconnectObserver(t){const e=this[t];e&&e.disconnect()},getStickyTop(){this.stickyTop=m(this.offsetTop)+m(this.customNavHeight)},async checkSupportCssSticky(){this.checkCssStickyForH5()&&(this.cssSticky=!0),"android"===B()&&Number(b().system)>8&&(this.cssSticky=!0),"ios"===B()&&(this.cssSticky=!0)},checkComputedStyle(){},checkCssStickyForH5(){const t=["","-webkit-","-ms-","-moz-","-o-"],e=t.length,i=document.createElement("div");for(let s=0;s<e;s++)if(i.style.position=t[s]+"sticky",""!==i.style.position)return!0;return!1}},beforeUnmount(){this.disconnectObserver("contentObserver")}},[["render",function(t,e,i,s,a,n){const d=L;return l(),r(d,{class:"u-sticky",id:a.elId,style:h([n.style])},{default:o((()=>[_(d,{style:h([n.stickyContent]),class:"u-sticky__content"},{default:o((()=>[w(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"])])),_:3},8,["id","style"])}],["__scopeId","data-v-dbb1d77f"]]);const P=H({name:"u-waterfall",props:{modelValue:{type:Array,required:!0,default:function(){return[]}},addTime:{type:[Number,String],default:200},idKey:{type:String,default:"id"}},data:()=>({leftList:[],rightList:[],tempList:[],children:[]}),watch:{copyFlowList(t,e){let i=Array.isArray(e)&&e.length>0?e.length:0;this.tempList=this.tempList.concat(this.cloneData(t.slice(i))),this.splitData()}},mounted(){this.tempList=this.cloneData(this.copyFlowList),this.splitData()},computed:{copyFlowList(){return this.cloneData(this.modelValue)}},emits:["update:modelValue"],methods:{async splitData(){if(!this.tempList.length)return;let t=await this.$uGetRect("#u-left-column"),e=await this.$uGetRect("#u-right-column"),i=this.tempList[0];i&&(t.height<e.height?this.leftList.push(i):t.height>e.height?this.rightList.push(i):this.leftList.length<=this.rightList.length?this.leftList.push(i):this.rightList.push(i),this.tempList.splice(0,1),this.tempList.length&&setTimeout((()=>{this.splitData()}),this.addTime))},cloneData:t=>JSON.parse(JSON.stringify(t)),clear(){this.leftList=[],this.rightList=[],this.$emit("update:modelValue",[]),this.tempList=[]},remove(t){let e=-1;e=this.leftList.findIndex((e=>e[this.idKey]==t)),-1!=e?this.leftList.splice(e,1):(e=this.rightList.findIndex((e=>e[this.idKey]==t)),-1!=e&&this.rightList.splice(e,1)),e=this.modelvalue.findIndex((e=>e[this.idKey]==t)),-1!=e&&this.$emit("input",this.modelvalue.splice(e,1))},modify(t,e,i){let s=-1;if(s=this.leftList.findIndex((e=>e[this.idKey]==t)),-1!=s?this.leftList[s][e]=i:(s=this.rightList.findIndex((e=>e[this.idKey]==t)),-1!=s&&(this.rightList[s][e]=i)),s=this.modelvalue.findIndex((e=>e[this.idKey]==t)),-1!=s){let t=this.cloneData(this.modelvalue);t[s][e]=i,this.$emit("update:modelValue",t)}}}},[["render",function(t,e,i,s,a,n){const d=L;return l(),r(d,{class:"u-waterfall"},{default:o((()=>[_(d,{id:"u-left-column",class:"u-column"},{default:o((()=>[w(t.$slots,"left",{leftList:a.leftList},void 0,!0)])),_:3}),_(d,{id:"u-right-column",class:"u-column"},{default:o((()=>[w(t.$slots,"right",{rightList:a.rightList},void 0,!0)])),_:3})])),_:3})}],["__scopeId","data-v-6e9dcc08"]]),q=D({__name:"WallpaperList",props:{wallpaperListData:{}},setup(t,{expose:e}){let i=I(null);const s=t;console.log(s.wallpaperListData);const a=t=>{console.log(t);let e={imgUrl:t.img,preview:t.preview};R({url:"/pages/detailsImg/index"+z(e)})};return e({clear:()=>{i.value.clear()}}),(t,e)=>{const n=y(v("up-lazy-load"),W),d=L,u=y(v("up-waterfall"),P);return l(),r(d,{class:"wallpaper-box"},{default:o((()=>[_(u,{modelValue:s.wallpaperListData,"onUpdate:modelValue":e[0]||(e[0]=t=>s.wallpaperListData=t),ref_key:"uWaterfallRef",ref:i},{left:o((({leftList:t})=>[(l(!0),x(S,null,k(t,((t,e)=>(l(),r(d,{key:e,style:{margin:"10rpx"}},{default:o((()=>[_(n,{threshold:"-450","border-radius":"10",image:t.thumb,index:e,"loading-img":O(F),"error-img":O(Z),onClick:e=>a(t)},null,8,["image","index","loading-img","error-img","onClick"])])),_:2},1024)))),128))])),right:o((({rightList:t})=>[(l(!0),x(S,null,k(t,((t,e)=>(l(),r(d,{key:e,style:{margin:"10rpx"}},{default:o((()=>[_(n,{threshold:"-450","border-radius":"10",image:t.thumb,index:e,"loading-img":O(F),"error-img":O(Z),onClick:e=>a(t)},null,8,["image","index","loading-img","error-img","onClick"])])),_:2},1024)))),128))])),_:1},8,["modelValue"])])),_:1})}}}),E="https://service.picasso.adesk.com/v1/vertical",Q={...Object.freeze(Object.defineProperty({__proto__:null,YdBaseUrl:E,getYdHotList:t=>$.get(E+"/vertical?limit=10&skip="+t+"&adult=false&first=0&order=hot"),getYdList:(t,e)=>$.get(E+"/category/"+t+"/vertical?limit=10&adult=false&first=1&skip="+e+"&order=new"),getYdNewList:t=>$.get(E+"/vertical?limit=10&skip="+t+"&adult=false&first=0&order=new"),getYdType:()=>$.get(E+"/category")},Symbol.toStringTag,{value:"Module"}))},J=H(D({__name:"index",setup(t){let e=I([]),i=I([]),s=I(null),a=I(0),n=I("loadmore"),d=I("1");U((async()=>{Q.getYdType().then((t=>{e.value=t.data.res.category,e.value.unshift({id:"2",name:"热榜"}),e.value.unshift({id:"1",name:"最新"})})),await h()}));const u=t=>{console.log(t),"1"==t.id?(a.value=0,d.value="1",i.value=[],s.value.clear(),h()):"2"==t.id?(a.value=0,d.value="2",i.value=[],s.value.clear(),h(),console.log(i.value)):(a.value=0,d.value=t.id,i.value=[],s.value.clear(),h())},h=async()=>{let t;n.value="loading",t="1"==d.value?await Q.getYdNewList(a.value):"2"==d.value?await Q.getYdHotList(a.value):await Q.getYdList(d.value,a.value),i.value.push(...t.data.res.vertical),t.data.res.vertical.length<10?n.value="nomore":n.value="loadmore",a.value=a.value+10};return V((()=>{h()})),(t,a)=>{const d=y(v("up-tabs"),G),c=y(v("up-sticky"),K),p=y(v("up-loadmore"),Y),g=L;return l(),r(g,{class:"home-box"},{default:o((()=>[_(c,{bgColor:"#fff","offset-top":"-44"},{default:o((()=>[_(d,{list:O(e),onClick:u,lineWidth:"20",lineHeight:"7",lineColor:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAOCAYAAABdC15GAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFxSURBVHgBzZNRTsJAEIb/WTW+lpiY+FZPIDew3ABP4GJ8hxsI9zBpOYHeQDwBPQI+mRiRvpLojtPdYhCorQqF/6GdbGd2vvwzBXZcNAt4oj1ANeUoAT5iqkUjbEFLHNmhD1YPEvpZ3ghkGlVDCkc94/BmHMq998I5ONiY1ZBfpKAyuOtgAc5yOEDmYEWNh32BHF91sGHZHmwW4azciN9aQwnz3SJEgOmte+R2tdLprTYoa50mvuomlLpD4Y3oQZnov6D2RzCqI93bWOHaEmAGqQUyRBlZR1WfarcD/EJ2z8DtzDGvsMCwpm8XOCfDUsVOCYhiqRxI/CTQo4UOvjzO7Pow18vfywneuUHHUUxLn55lLw5JFpZ8bEUcY8oXdOLWiHLTxvoGpLqoUmy6dBT15o/ox3znpoycAmxUsiJTbs1cmxeVKp+0zmFIS7bGWiVghC7Vwse8jFKAX9eljh4ggKLLv7uaQvG9/F59Oo2SouxPu7OTCxN/s8wAAAAASUVORK5CYII=) 100% 100%",activeStyle:{color:"#303133",fontWeight:"bold",transform:"scale(1.05)"},inactiveStyle:{color:"#606266",transform:"scale(1)"},itemStyle:"padding-left: 15px; padding-right: 15px; height: 34px;"},null,8,["list","lineColor","activeStyle","inactiveStyle"])])),_:1}),_(g,{class:"home-content"},{default:o((()=>[_(q,{wallpaperListData:O(i),ref_key:"FnWallpaperList",ref:s},null,8,["wallpaperListData"]),_(p,{status:O(n),onLoadmore:h},null,8,["status"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-d6e1343e"]]);export{J as default};
